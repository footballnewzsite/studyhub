<!doctype html>
<html lang="el">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Wireshark — Πλήρης Οδηγός & Labs</title>
<link rel="stylesheet" href="style.css">
<link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
<link rel="alternate icon" type="image/png" href="assets/favicon.png">
<meta property="og:image" content="assets/banner.png">
<meta property="og:title" content="StudyHub — Cybersecurity Exam Prep">
<meta property="og:description" content="Πλήρης οδηγός προετοιμασίας για εξετάσεις Κυβερνοασφάλειας">

<style>
:root {
  --accent: #ff4d4d;
}
body {
  background:#0d1117;
  color:#e6e6e6;
  font-family: "Segoe UI", sans-serif;
  line-height:1.6;
}
header {background:#111; border-bottom:2px solid var(--accent);}
.header .nav a.active {color:var(--accent);}
h1,h2,h3{color:var(--accent);}
code,pre{background:#161b22;color:#fff;padding:4px 6px;border-radius:6px;}
.table{border-collapse:collapse;width:100%;margin-top:10px;}
.table th,.table td{border:1px solid #333;padding:8px;}
.diagram svg{max-width:100%;display:block;margin:auto;}
</style>
</head>
<body>

<header class="header">
  <div class="container">
    <div class="logo">StudyHub — Wireshark & Packet Analysis</div>
    <nav class="nav">
      <a href="networks.html">Networking</a>
      <a href="wireshark.html" class="active">Wireshark</a>
      <a href="standards.html">Standards</a>
      <a href="csirt.html">CSIRT</a>
      <a href="mock_exams.html">Mock Exams</a>
      <a href="glossary.html">Glossary</a>
    </nav>
  </div>
</header>

<main class="container">
  <div class="card">
    <h1>Wireshark — Packet Capture & Analysis</h1>

    <h2>1. Εισαγωγή</h2>
    <p>
      Το <strong>Wireshark</strong> είναι ένα ισχυρό εργαλείο packet capture και analysis (Network Protocol Analyzer).  
      Χρησιμοποιείται από αναλυτές, forensic examiners, penetration testers και CSIRTs για:
    </p>
    <ul>
      <li>Κατανόηση της ροής δεδομένων (TCP/UDP, HTTP, DNS, SSL/TLS)</li>
      <li>Ανίχνευση ανωμαλιών, καθυστερήσεων ή ύποπτων δραστηριοτήτων</li>
      <li>Απόδειξη επίθεσης (forensic evidence)</li>
    </ul>

    <h2>2. Εγκατάσταση</h2>
    <ul>
      <li><strong>Windows:</strong> Κατεβάστε το Wireshark από <a href="https://www.wireshark.org/download.html" target="_blank">wireshark.org</a>.</li>
      <li>Περιλαμβάνει το <strong>Npcap</strong> driver για packet capturing.</li>
      <li><strong>Linux:</strong> <code>sudo apt install wireshark</code> ή <code>dnf install wireshark</code></li>
      <li><strong>macOS:</strong> μέσω Homebrew <code>brew install wireshark</code></li>
    </ul>

    <h2>3. Εννοιολογική εικόνα capture</h2>
    <div class="diagram">
      <svg viewBox="0 0 800 200">
        <rect width="100%" height="100%" fill="#0d1117"/>
        <g fill="#e6e6e6" font-family="Arial" font-size="13">
          <text x="60" y="40">Application Layer (HTTP, DNS, TLS)</text>
          <text x="60" y="80">Transport Layer (TCP, UDP)</text>
          <text x="60" y="120">Network Layer (IP)</text>
          <text x="60" y="160">Data Link Layer (Ethernet)</text>
        </g>
        <rect x="450" y="40" width="300" height="120" rx="10" ry="10" fill="none" stroke="#ff4d4d" stroke-width="2"/>
        <text x="470" y="105" fill="#ff4d4d" font-family="Arial">Wireshark Capture & Decode</text>
      </svg>
    </div>

    <h2>4. Packet Capture vs Display Filters</h2>
    <p>
      Υπάρχουν δύο βασικοί τύποι φίλτρων:
    </p>
    <ul>
      <li><strong>Capture filters (BPF):</strong> καθορίζουν ποια packets θα καταγραφούν (π.χ. <code>tcp port 80</code>)</li>
      <li><strong>Display filters:</strong> καθορίζουν τι εμφανίζεται στο GUI (π.χ. <code>http && ip.src==192.168.1.10</code>)</li>
    </ul>

    <h3>Συχνά Capture Filters</h3>
    <pre>
host 192.168.1.5
net 10.0.0.0/24
tcp port 443
udp port 53
icmp
not broadcast and not multicast
    </pre>

    <h3>Συχνά Display Filters</h3>
    <pre>
ip.addr == 8.8.8.8
tcp.flags.syn == 1 and tcp.flags.ack == 0
dns.qry.name contains "example.com"
http.request.method == "POST"
tls.handshake.type == 1
    </pre>

    <h2>5. Ανάλυση TCP 3-way Handshake</h2>
    <ol>
      <li><strong>SYN</strong>: Client → Server (Initiate)</li>
      <li><strong>SYN/ACK</strong>: Server → Client (Acknowledge)</li>
      <li><strong>ACK</strong>: Client → Server (Confirm)</li>
    </ol>
    <p>Σε Wireshark φίλτρο: <code>tcp.flags.syn==1</code> δείχνει το πρώτο handshake.</p>

    <h2>6. Ανάλυση DNS / HTTP / ARP Traffic</h2>
    <h3>DNS Lookup</h3>
    <pre>
Frame 1: 74 bytes
Query: example.com  Type: A  → Response: 93.184.216.34
Filter: dns
    </pre>

    <h3>HTTP Request</h3>
    <pre>
GET /index.html HTTP/1.1
Host: example.com
User-Agent: Mozilla/5.0
Filter: http.request
    </pre>

    <h3>ARP Exchange</h3>
    <pre>
Who has 192.168.1.1? Tell 192.168.1.10
192.168.1.1 is at 00:11:22:33:44:55
Filter: arp
    </pre>

    <h2>7. Labs (Step-by-Step)</h2>

    <h3>Lab 1 — Capture και Αναγνώριση Handshake</h3>
    <ol>
      <li>Άνοιξε Wireshark και ξεκίνησε capture στο interface (π.χ. Ethernet ή Wi-Fi).</li>
      <li>Άνοιξε ένα browser και μπες στο <code>http://example.com</code>.</li>
      <li>Σταμάτησε capture, εφάρμοσε filter: <code>tcp.flags.syn==1</code>.</li>
      <li>Παρατήρησε τη ροή SYN → SYN/ACK → ACK.</li>
    </ol>

    <h3>Lab 2 — DNS Query Tracking</h3>
    <ol>
      <li>Filter: <code>dns</code></li>
      <li>Βρες <code>Standard query 0x...</code> και την απάντηση.</li>
      <li>Δες το “Response time” στη στήλη Info — χρησιμοποίησε το Statistics → Service Response Time → DNS.</li>
    </ol>

    <h3>Lab 3 — TLS Session Analysis</h3>
    <ol>
      <li>Filter: <code>tls.handshake.type==1</code> (Client Hello)</li>
      <li>Παρατήρησε τα “Cipher Suites”, “Server Name Indication (SNI)”</li>
      <li>Filter: <code>tls.handshake.type==2</code> (Server Hello)</li>
    </ol>

    <h3>Lab 4 — Suspicious Traffic Detection</h3>
    <p>Εντοπισμός ύποπτης επικοινωνίας (e.g. beaconing)</p>
    <pre>
frame.time_delta_displayed > 5 and ip.dst==198.51.100.45
    </pre>
    <p>Αναζητά πακέτα με χρονικά διαστήματα μεγαλύτερα των 5s προς συγκεκριμένο IP.</p>

    <h3>Lab 5 — Export Objects (HTTP, SMB)</h3>
    <ol>
      <li>File → Export Objects → HTTP → Save selected file.</li>
      <li>Για forensic χρήση: επιτρέπει ανάκτηση αρχείων που μεταφέρθηκαν χωρίς κρυπτογράφηση.</li>
    </ol>

    <h2>8. Προχωρημένες Λειτουργίες</h2>
    <ul>
      <li><strong>Statistics → Conversations:</strong> δείχνει συνολική επικοινωνία ανά IP ή MAC.</li>
      <li><strong>Follow → TCP Stream:</strong> πλήρης ανασύνθεση συνεδρίας.</li>
      <li><strong>IO Graphs:</strong> οπτικοποίηση ρυθμού μεταφοράς (bps / pps).</li>
      <li><strong>Coloring Rules:</strong> π.χ. κόκκινο για retransmissions (<code>tcp.analysis.retransmission</code>).</li>
    </ul>

    <h2>9. Quick Troubleshooting Examples</h2>
    <table class="table">
      <tr><th>Σενάριο</th><th>Wireshark Filter</th><th>Ανάλυση</th></tr>
      <tr><td>Αργό HTTP site</td><td>tcp.analysis.flags</td><td>Δες retransmissions & latency per packet</td></tr>
      <tr><td>DNS failure</td><td>dns.flags.rcode != 0</td><td>RCODE 2=Server failure, 3=NXDOMAIN</td></tr>
      <tr><td>ICMP unreachable</td><td>icmp.type==3</td><td>Δες gateway που στέλνει το unreachable</td></tr>
    </table>

    <h2>10. Ερωτήσεις Εξάσκησης (Exam Prep)</h2>
    <h3>Q1.</h3><p>Ποια είναι η διαφορά capture filter και display filter;</p>
    <p><strong>A:</strong> Capture = τι πακέτα συλλέγονται, Display = τι προβάλλεται στο GUI.</p>

    <h3>Q2.</h3><p>Πώς εντοπίζουμε το TCP handshake σε capture;</p>
    <p><strong>A:</strong> Φίλτρο <code>tcp.flags.syn==1</code> — βλέπουμε τρία πακέτα SYN, SYN/ACK, ACK.</p>

    <h3>Q3.</h3><p>Ποιο φίλτρο δείχνει όλα τα DNS queries προς domain που περιέχει "edu";</p>
    <p><strong>A:</strong> <code>dns.qry.name contains "edu"</code></p>

    <h3>Q4.</h3><p>Ποια επιλογή στο Wireshark επιτρέπει να ανασυνθέσεις ένα κατεβασμένο αρχείο;</p>
    <p><strong>A:</strong> File → Export Objects → HTTP (ή SMB)</p>

    <h3>Q5.</h3><p>Τι δείχνει το Statistics → Conversations;</p>
    <p><strong>A:</strong> Την πλήρη λίστα IP pairs που αντάλλαξαν πακέτα, με bytes, packets και χρονικά στοιχεία.</p>

    <h2>11. Quick Reference Sheet</h2>
    <pre>
Ctrl+E — Start/Stop capture
Ctrl+K — Clear display filter
Ctrl+F — Find packet
Ctrl+H — Follow TCP stream
Ctrl+Shift+T — IO Graphs
Ctrl+Alt+F — Apply as Filter
    </pre>

    <h2>12. Επανάληψη — 10 σημεία για εξετάσεις</h2>
    <ol>
      <li>Κατανόησε TCP 3-way handshake & flags.</li>
      <li>Γνώρισε DNS query/response format.</li>
      <li>Μάθε φίλτρα display/capture.</li>
      <li>Ανάλυση TLS handshake & SNI.</li>
      <li>Follow TCP stream — reconstruction.</li>
      <li>Export Objects για forensic recovery.</li>
      <li>Statistics → IO Graphs.</li>
      <li>χρήση time delta για detection.</li>
      <li>χρήση color rules για packet types.</li>
      <li>Αναγνώριση επιθέσεων: SYN flood, DNS tunneling, beaconing.</li>
    </ol>
  </div>
</main>
</body>
</html>
